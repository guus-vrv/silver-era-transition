{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate,useParams,useLocation}from'react-router-dom';// Import useHistory from react-router-dom\nimport axiosInstance from'../Auth/AxiosInstance';// Assuming AxiosInstance is set up for authenticated requests\nimport{jwtDecode as jwt_decode}from'jwt-decode';// if you want to keep calling it jwt_decode\nimport'../BuyersSellers/styles/ProfilesDisplay.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL;// Access the base URL from environment variable\nconst SelectChatProfiles=()=>{var _location$state,_location$state2;const[activeProfileId,setActiveProfileId]=useState(null);const[message,setMessage]=useState('');const[profiles,setProfiles]=useState([]);const{roomNumber}=useParams();const[profilesToAdd,setProfilesToAdd]=useState([]);const navigate=useNavigate();const location=useLocation();const loc_groupChat=(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.groupChat;const loc_profilesToAdd=(_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.profilesToAdd;useEffect(()=>{if(loc_profilesToAdd){setProfilesToAdd(loc_profilesToAdd);}},[]);const fetchProfiles=async()=>{try{const response=await axiosInstance.get(`${API_URL}/api/profiles/broker-connected-users`);setProfiles(response.data.profiles);// dan wanneer de profielen gefetcht zijn komt er de optie voor de broker om een gebruiker te selecteren. Dit wordt gelijk aan het saved/skipped profile pagina\n}catch(error){console.error('Error fetching profiles data:',error);}};useEffect(()=>{fetchProfiles();},[]);const showInvite=profileId=>{setActiveProfileId(profileId);// Set the active profile ID to the clicked profile\n};const closeInvite=()=>{setActiveProfileId(null);// Clear the active profile ID to close the pop-up\n};const addProfile=profileId=>{// Implement your invite functionality here\n// add profile to state variable\nsetProfilesToAdd([...profilesToAdd,profileId]);setActiveProfileId('');};const deleteProfile=profileId=>{setProfilesToAdd(profilesToAdd=>profilesToAdd.filter(profile=>profile!==profileId));};const submitChoice=async()=>{try{const response=await axiosInstance.post(`${API_URL}/api/groupchat/create-from-members`,profilesToAdd);navigate(`/add-room/${roomNumber}`,{state:{groupChat:response.data.groupChat._id,profilesToAdd:profilesToAdd}});// dan wanneer de profielen gefetcht zijn komt er de optie voor de broker om een gebruiker te selecteren. Dit wordt gelijk aan het saved/skipped profile pagina\n}catch(error){console.error('Error creating groupchat:',error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-button\",onClick:()=>navigate(`/add-room/${roomNumber}`,{state:{groupChat:loc_groupChat,profilesToAdd:profilesToAdd}}),children:\"Back\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profiles-container\",children:profiles.map(profile=>/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:profile.profile.profilePicture?`${API_URL}${profile.profile.profilePicture}`:''// Default image if not available\n,alt:profile.profile.name,className:\"profile-picture\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"profile-name\",children:profile.profile.name}),/*#__PURE__*/_jsx(\"p\",{className:\"about-section\",children:profile.profile.introduceYourself}),profilesToAdd.includes(profile.profile.user)?/*#__PURE__*/_jsx(\"button\",{className:\"button\",style:{backgroundColor:'red'},onClick:()=>deleteProfile(profile.profile.user),children:\"Remove\"}):activeProfileId!==profile.profile.user&&/*#__PURE__*/_jsx(\"button\",{className:\"invite-button\",onClick:()=>showInvite(profile.profile.user),children:\"Choose\"}),activeProfileId===profile.profile.user&&/*#__PURE__*/_jsx(\"div\",{className:\"right-box\",children:/*#__PURE__*/_jsx(\"div\",{className:\"invite-box\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"invite-profile-container\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"invite-button\",onClick:()=>addProfile(profile.profile.user),children:\"Add\"}),/*#__PURE__*/_jsx(\"button\",{className:\"skip-button\",onClick:closeInvite,style:{backgroundColor:'red'},children:\"Close\"})]})})})]},profile.profile.user))}),/*#__PURE__*/_jsx(\"button\",{style:{marginTop:'2rem'},className:\"submit-button\",onClick:()=>submitChoice(),children:\"Create Chat With Selected Profiles\"})]});};export default SelectChatProfiles;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useParams","useLocation","axiosInstance","jwtDecode","jwt_decode","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","SelectChatProfiles","_location$state","_location$state2","activeProfileId","setActiveProfileId","message","setMessage","profiles","setProfiles","roomNumber","profilesToAdd","setProfilesToAdd","navigate","location","loc_groupChat","state","groupChat","loc_profilesToAdd","fetchProfiles","response","get","data","error","console","showInvite","profileId","closeInvite","addProfile","deleteProfile","filter","profile","submitChoice","post","_id","children","className","onClick","map","src","profilePicture","alt","name","introduceYourself","includes","user","style","backgroundColor","marginTop"],"sources":["/Users/guusvanrees/Documents/Programming/projects/SET/client/src/components/Brokers/SelectChatProfiles.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams, useLocation } from 'react-router-dom'; // Import useHistory from react-router-dom\nimport axiosInstance from '../Auth/AxiosInstance'; // Assuming AxiosInstance is set up for authenticated requests\nimport { jwtDecode as jwt_decode } from 'jwt-decode'; // if you want to keep calling it jwt_decode\nimport '../BuyersSellers/styles/ProfilesDisplay.css';\n\nconst API_URL = process.env.REACT_APP_API_URL; // Access the base URL from environment variable\n\nconst SelectChatProfiles = () => {\n\n  const [activeProfileId, setActiveProfileId] = useState(null);\n  const [message, setMessage] = useState('');\n  const [profiles, setProfiles] = useState([]);\n  const {roomNumber} = useParams();\n  const [profilesToAdd, setProfilesToAdd] = useState([]);\n\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const loc_groupChat = location.state?.groupChat\n  const loc_profilesToAdd = location.state?.profilesToAdd;\n\n  useEffect(() => {\n    if (loc_profilesToAdd)\n    {\n      setProfilesToAdd(loc_profilesToAdd);\n    }\n    \n  }, []);\n\n  const fetchProfiles = async () => {\n    try {\n      const response = await axiosInstance.get(`${API_URL}/api/profiles/broker-connected-users`);\n      setProfiles(response.data.profiles);\n      // dan wanneer de profielen gefetcht zijn komt er de optie voor de broker om een gebruiker te selecteren. Dit wordt gelijk aan het saved/skipped profile pagina\n    } catch (error) {\n      console.error('Error fetching profiles data:', error);\n    }\n\n};\n\n  useEffect(() => {\n    fetchProfiles();\n  }, []);\n\n  const showInvite = (profileId) => {\n    setActiveProfileId(profileId); // Set the active profile ID to the clicked profile\n  };\n\n  const closeInvite = () => {\n    setActiveProfileId(null); // Clear the active profile ID to close the pop-up\n  };\n\n  const addProfile = (profileId) => {\n    // Implement your invite functionality here\n      // add profile to state variable\n  \n      setProfilesToAdd([...profilesToAdd, profileId]);\n      setActiveProfileId('');\n    };\n\n  const deleteProfile = (profileId) => {\n    setProfilesToAdd(profilesToAdd => profilesToAdd.filter(profile => profile !== profileId));\n\n  }\n\n  const submitChoice =  async () => {\n    try {\n        const response = await axiosInstance.post(`${API_URL}/api/groupchat/create-from-members`, profilesToAdd);\n        navigate(`/add-room/${roomNumber}`, { state: { groupChat: response.data.groupChat._id, profilesToAdd: profilesToAdd } });\n        // dan wanneer de profielen gefetcht zijn komt er de optie voor de broker om een gebruiker te selecteren. Dit wordt gelijk aan het saved/skipped profile pagina\n      } catch (error) {\n        console.error('Error creating groupchat:', error);\n      }\n  }\n\n\n  return (\n    <div>\n      <button className='back-button' onClick={() => navigate(`/add-room/${roomNumber}`, {state: {groupChat: loc_groupChat, profilesToAdd: profilesToAdd}})}>Back</button>\n\n      <div className=\"profiles-container\">\n         \n    \n        {profiles.map(profile => (\n\n        <div className=\"profile-card\" key={profile.profile.user}>\n          <img\n            src={profile.profile.profilePicture ? `${API_URL}${profile.profile.profilePicture}` : ''} // Default image if not available\n            alt={profile.profile.name}\n            className=\"profile-picture\"\n          />\n          <h3 className=\"profile-name\">{profile.profile.name}</h3>\n          <p className=\"about-section\">{profile.profile.introduceYourself}</p>\n\n          {profilesToAdd.includes(profile.profile.user) ? (<button className=\"button\" style={{backgroundColor: 'red'}} onClick={() => deleteProfile(profile.profile.user)}>\n              Remove\n          </button> ) : (activeProfileId !== profile.profile.user && (\n            <button className=\"invite-button\" onClick={() => showInvite(profile.profile.user)}>\n              Choose\n          </button> ))\n            \n          }\n          \n          {activeProfileId === profile.profile.user && (\n            <div className=\"right-box\">\n              <div className=\"invite-box\">\n                <div className=\"invite-profile-container\">\n                  <button\n                    className=\"invite-button\"\n                    onClick={() => addProfile(profile.profile.user)}\n                  >\n                    Add\n                  </button>\n                  <button className=\"skip-button\" onClick={closeInvite} style={{backgroundColor: 'red'}}>\n                    Close\n                  </button>\n                </div>\n              </div>\n            </div>\n            \n          )}\n\n          </div>\n\n          ))}\n\n    </div>\n\n    <button  style={{marginTop: '2rem'}} className='submit-button' onClick={() => submitChoice()}>Create Chat With Selected Profiles</button>\n        \n    \n    </div>\n    \n  );\n};\n\nexport default SelectChatProfiles;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}